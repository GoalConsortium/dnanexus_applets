#!/bin/bash
# trim_galore 0.0.1
# Generated by dx-app-wizard.

main() {

    dx download "$fq1" -o seq.R1.fastq.gz
    if [ -n "$fq2" ]
    then
        dx download "$fq2" -o seq.R2.fastq.gz
    fi

    docker run -v ${PWD}:/data docker.io/goalconsortium/trim_galore:1.0.0 bash /usr/local/bin/trimgalore.sh -p ${pair_id} -a seq.R1.fastq.gz -b seq.R2.fastq.gz -f

    trim1=$(dx upload ${pair_id}.trim.R1.fastq.gz --brief)
    trimreport=$(dx upload ${pair_id}.trimreport.txt --brief)
    
    dx-jobutil-add-output trim1 "$trim1" --class=file
    dx-jobutil-add-output trimreport "$trimreport" --class=file

    if [ -n "$fq2" ]
    then
	trim2=$(dx upload ${pair_id}.trim.R2.fastq.gz --brief)
	dx-jobutil-add-output trim2 "$trim2" --class=file
    fi
}
